<!-- <div class="modal-container">
  <div class="modal-window"> -->
    <div class="modal-content" style="margin: 0 auto;">
    <!--페이지 타이틀-->
	<div class="dialog-title1" style="position: absolute">
      <ul>
        <li>
            <h5 id="dialog-title1-dialog_container_main">블루투스 제어하기</h5>
        </li>
        <!-- <li style="float:right">
            <img id="dialog-close-id_dialog_users" class="dialog-close" src="/images/close2.png" />
        </li> -->
      </ul>
    </div>

    <div class="margin_33px"></div>
    
    <div>
      <div class="margin_10px"></div>
      <!-- <div id="dialog-title2-dialog_container_main" class="dialog-title2">제품의 데이터를 추가하여 주시기 바랍니다.</div> -->
      <div class="stretch_wrap layout_max1000" style="height:80px;">
        <div class="stretch_left_100percent" style="right:80px;">
          <div id="dialog-title2-dialog_container_main" class="dialog-title2">1. 블루투스 연결<br>2. 디바이스 선택<br>3. 전송할 값을 입력 후 전송</div>
        </div>
        <div class="stretch_right_100px" style="max-width:60px">
          <img id="dialog_write_image_1" src="/images/cat1.png" data-magnify="gallery">
          <!-- <img id="dialog_write_image_1" src="/images/cat1.png" class="round_image" data-magnify="gallery"> -->
        </div>
      </div>
      <div class="margin_10px"></div>
    </div>

    <div id="container" class="layout_max1000">
      <!--content//-->
      <div id="content">
        <div class="dialog-buttons">
          <button id="btnBluetooth" class="button">블루투스 OFF</button>
          <button id="btnDevice" class="button">디바이스 OFF</button>

		  	<button type="button" onclick="init()">Start</button>
			<div id="label-container"></div>
        </div>
        
          <div id="dialog_write">
            

            <table cellspacing="0" cellpadding="0" class="table_layout">
              <colgroup>
                <col width="25%" style="min-width:100px">
                <col width="75%">
              </colgroup>
              
              <tbody>
              <tr>
              </tr>
              <tr style="display:none">
                <th>아이디</th>
                <td>
                    <div class="stretch_wrap" style="height:36px">
                      <div id="dialog_write_user_id_wrap" class="stretch_left_100percent" style="right:80px;">
                        <input id="dialog_write_user_id" type="text" size="30" maxlength="20" class="inputbox1 mustimage" value="test" style="white-space:nowrap">
                      </div>
                      <div id="dialog_write_check_user_wrap" class="stretch_right_100px" style="max-width:80px">
                        <a id="dialog_write_check_user" href="#" class="button_style1">중복 확인</a>
                      </div>
                    </div>
                </td>
              </tr>
              <tr style="display:none">
                <th>비밀번호</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_password_wrap" class="stretch_left_100percent" style="right:80px;">
                      <input id="dialog_write_password" type="password" class="inputbox1 mustimage" maxlength="30">
                    </div>
                    <div id="dialog_write_password_change_warp" class="stretch_right_100px" style="max-width:80px">
                      <a id="dialog_write_password_change" href="#" class="button_style1">변경</a>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th>보내기</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_position_wrap" class="stretch_left_100percent" style="right:80px;">
                      <input id="dialog_write_serial" type="text" class="inputbox1" maxlength="30">
                    </div>
                    <div id="dialog_write_serial_warp" class="stretch_right_100px" style="max-width:80px">
						<button id="dialog_write_serial_change" class="button_style1">전송</button>
                      <!-- <a id="dialog_write_serial_change" href="#" class="button_style1">전송</a> -->
                    </div>
                  </div>
                </td>
                <tr>
                  <th>받기</th>
                  <td><textarea id="dialog_receive_data" class="inputbox1" style="height:300px;" ></textarea></td>
                </tr>
              </tr>

              <!-- <tr>
                <th>이름</th>
                <td><input id="dialog_write_name" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr style="display:none">
                <th>이메일</th>
                <td><input id="dialog_write_email" type="text" class="inputbox1" maxlength="50"></td>
              </tr>
              <tr style="display:none">
                <th>모바일</th>
                <td><input id="dialog_write_mobile" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr style="display:none">
                <th>고유번호</th>
                <td><input id="dialog_write_no" type="text" class="inputbox1" maxlength="30" readonly></td>
              </tr>
              <tr>
                <th>등록일자</th>
                <td><input id="dialog_write_regist_datetime" type="text" class="inputbox1" maxlength="30" readonly></td>
              </tr>
              <tr>
                <th>최종수정일자</th>
                <td><input id="dialog_write_lastsave_datetime" type="text" class="inputbox1" maxlength="30" readonly></td>
              </tr>
              <tr style="display:none">
                <th>라이선스</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div class="stretch_left_100percent" style="right:36px;margin-right: 3px">
                        <input id="dialog_write_license_date" type="text" class="inputbox1" maxlength="30">
                    </div>
                    <div class="stretch_right_100px" style="max-width:36px">
                      <div id="dialog_write_license_date_divimage" class="datepicker1" style="width:100%;height:100%;padding:1px;">

                      </div>
                    </div>
                    <div id="dialog_write_license_date_divimage" class="stretch_right_100px datepicker1" style="max-width:36px">
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th>권한</th>
                <td>
                  <select id="dialog_write_auth" class="select1">
                  </select>
                </td>
              </tr>
              <tr style="display:none">
                <th>권한</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_auth_wrap" class="stretch_left_100percent" style="right:80px;">
                      <select id="dialog_write_auth" class="select1">
                      </select>
                    </div>
                    <div id="dialog_write_auth_change_warp" class="stretch_right_100px" style="max-width:80px">
                      <a id="dialog_write_auth_change" href="#" class="button_style1">찾기</a>
                    </div>
                  </div>
                </td>
              </tr>
              <tr style="display:none">
                <th>부서</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_dept_wrap" class="stretch_left_100percent" style="right:80px;">
                      <select id="dialog_write_dept" class="select1">
                      </select>
                    </div>
                    <div id="dialog_write_dept_change_warp" class="stretch_right_100px" style="max-width:80px">
                      <a id="dialog_write_dept_change" href="#" class="button_style1">찾기</a>
                    </div>
                  </div>
                </td>
              </tr>

              <tr>
                <th>부서</th>
                <td>
                  <select id="dialog_write_dept" class="select1">
                    <option value="일반사용자">일반사용자&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</option>
                    <option value="운영">운영</option>
                    <option value="운영관리자">운영관리자</option>
                    <option value="영업">영업</option>
                    <option value="영업관리자">영업관리자</option>
                    <option value="시스템관리자">시스템관리자</option>
                    <option value="admin">admin</option>
                    <option value="기타">기타</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th>직책</th>
                <td><input id="dialog_write_position" type="text" class="inputbox1" maxlength="100"></td>
              </tr>
              <tr>
                <th>직책</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_position_wrap" class="stretch_left_100percent" style="right:80px;">
                      <select id="dialog_write_position" class="select1">
                      </select>
                    </div>
                    <div id="dialog_write_position_change_warp" class="stretch_right_100px" style="max-width:80px">
                      <a id="dialog_write_position_change" href="#" class="button_style1">찾기</a>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th>분류</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div id="dialog_write_statususer_wrap" class="stretch_left_100percent" style="right:80px;">
                      <select id="dialog_write_statususer" class="select1">
                      </select>
                    </div>
                    <div id="dialog_write_statususer_change_warp" class="stretch_right_100px" style="max-width:80px">
                      <a id="dialog_write_statususer_change" href="#" class="button_style1">찾기</a>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <th>타입</th>
                <td>
                  <select id="dialog_write_type" class="select1">
                    <option value="type1">type1</option>
                    <option value="type1_1">type1_1</option>
                    <option value="type2">type2</option>
                    <option value="type3">type3</option>
                    <option value="type4">type4</option>
                    <option value="type5">type5</option>
                    <option value="type6">type6</option>
                    <option value="type_range1">type_range1</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th>업무1</th>
                <td><input id="dialog_write_task_1" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr>
                <th>업무2</th>
                <td><input id="dialog_write_task_2" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr>
                <th>업무3</th>
                <td><input id="dialog_write_task_3" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr>
                <th>업무4</th>
                <td><input id="dialog_write_task_4" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr style="display:none">
                <th>X좌표</th>
                <td><input id="dialog_write_x" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr style="display:none">
                <th>Y좌표</th>
                <td><input id="dialog_write_y" type="text" class="inputbox1" maxlength="30"></td>
              </tr>
              <tr>
                <th>스케일</th>
                <td>
                  <select id="dialog_write_scale" class="select1">
                    <option value="0.4">0.4</option>
                    <option value="0.5">0.5</option>
                    <option value="0.6">0.6</option>
                    <option value="0.7">0.7</option>
                    <option value="0.8">0.8</option>
                    <option value="0.9">0.9</option>
                    <option value="1">1</option>
                    <option value="1.1">1.1</option>
                    <option value="1.2">1.2</option>
                    <option value="1.3">1.3</option>
                    <option value="1.4">1.4</option>
                    <option value="1.5">1.5</option>
                    <option value="1.6">1.6</option>
                    <option value="1.7">1.7</option>
                    <option value="1.8">1.8</option>
                    <option value="1.9">1.9</option>
                    <option value="2">2</option> 
                  </select>
                </td>
              </tr> 

              <tr style="display:none">
                <th>RFID 코드</th>
                <td><input id="dialog_write_code_device" type="text" class="inputbox1" maxlength="30"></td>
              </tr>

              <tr>
                <th>이미지</th>
                <td>
                  <div class="stretch_wrap" style="height:36px">
                    <div class="stretch_left_100percent" style="right:36px;margin-right: 3px">
                      <input id="print_selected_imagename" type="text" class="inputbox1">
                    </div>                  
                    <div class="stretch_right_100px file_find" style="max-width:36px;">
                      <input id="dialog_write_image" type="file"/>
                    </div>
                  </div>
                </td>
              </tr>
              
            </tbody></table>
          </div>
        
          <div class="dialog-buttons">
            <button id="btnSave_dialog_users" class="button">저장</button>
            <button id="btnCancel_dialog_users" class="button">취소</button>
          </div>
        </div>
        -->
          <!--//content-->
      </div>
    </div>
  <!-- </div>
</div> -->
  
<!-- loading message -->
<div class="loading-container div_center_horizontally_vertically" style="position:fixed;margin:auto;display:none;">
    <div class="loading"></div>
    <div id="loading-text">기다려주세요</div>
</div>

<script>
document.getElementById('btnBluetooth').addEventListener('click', function() {
		if (this.textContent === "블루투스 OFF") {
			request_toAndroid("fromJavascriptCommand_bluetoothOn", null);
			this.textContent = "블루투스 ON";
			this.style.backgroundColor = "#3df396";
		} else {
			request_toAndroid("fromJavascriptCommand_bluetoothOff", null);
			this.textContent = "블루투스 OFF";
			this.style.backgroundColor = "";
		}
    });

	document.getElementById('btnDevice').addEventListener('click', function() {
		request_toAndroid("fromJavascriptCommand_listPairedDevices", null);
		if (this.textContent === "디바이스 OFF") {
			this.textContent = "디바이스 ON";
			this.style.backgroundColor = "#3df396";
		} else {
			this.textContent = "디바이스 OFF";
			this.style.backgroundColor = "";
		}
    });

	document.getElementById('dialog_write_serial_warp').addEventListener('click', function() {
		var sendData = document.getElementById('dialog_write_serial').value;
		request_toAndroid("fromJavascriptCommand_serialsend", sendData);
    });
</script>

<script type="text/javascript">
    // more documentation available at
    // https://github.com/tensorflow/tfjs-models/tree/master/speech-commands

    // the link to your model provided by Teachable Machine export panel
    //const URL = "http://www.yjsoft.kr/teachablemodel/";
	//const URL = "http://127.0.0.1:31419/teachablemodel/";
	const URL = "http://www.yjsoft.kr/teachablemodel/";

    async function createModel() {
        const checkpointURL = URL + "model.json"; // model topology
        const metadataURL = URL + "metadata.json"; // model metadata

        const recognizer = speechCommands.create(
            "BROWSER_FFT", // fourier transform type, not useful to change
            undefined, // speech commands vocabulary feature, not useful for your models
            checkpointURL,
            metadataURL);

        // check that model and metadata are loaded via HTTPS requests.
        await recognizer.ensureModelLoaded();

        return recognizer;
    }

    async function init() {
		JSON_POST_TEST();
		
        const recognizer = await createModel();
        const classLabels = recognizer.wordLabels(); // get class labels
        const labelContainer = document.getElementById("label-container");
        for (let i = 0; i < classLabels.length; i++) {
            labelContainer.appendChild(document.createElement("div"));
        }

        // listen() takes two arguments:
        // 1. A callback function that is invoked anytime a word is recognized.
        // 2. A configuration object with adjustable fields
        recognizer.listen(result => {
            const scores = result.scores; // probability of prediction for each class
            // render the probability scores per class
            for (let i = 0; i < classLabels.length; i++) {
                const classPrediction = classLabels[i] + ": " + result.scores[i].toFixed(2);
                labelContainer.childNodes[i].innerHTML = classPrediction;
            }
        }, {
            includeSpectrogram: true, // in case listen should return result.spectrogram
            probabilityThreshold: 0.75,
            invokeCallbackOnNoiseAndUnknown: true,
            overlapFactor: 0.50 // probably want between 0.5 and 0.75. More info in README
        });

        // Stop the recognition in 5 seconds.
        // setTimeout(() => recognizer.stopListening(), 5000);
    }
</script>